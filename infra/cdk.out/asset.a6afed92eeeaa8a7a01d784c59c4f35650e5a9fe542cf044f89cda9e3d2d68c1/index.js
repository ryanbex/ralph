"use strict";var c=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var l=(t,o)=>{for(var e in o)c(t,e,{get:o[e],enumerable:!0})},i=(t,o,e,n)=>{if(o&&typeof o=="object"||typeof o=="function")for(let r of m(o))!C.call(t,r)&&r!==e&&c(t,r,{get:()=>o[r],enumerable:!(n=d(o,r))||n.enumerable});return t};var y=t=>i(c({},"__esModule",{value:!0}),t);var O={};l(O,{handler:()=>P});module.exports=y(O);var s=require("@aws-sdk/client-dynamodb"),a=require("@aws-sdk/lib-dynamodb"),I=new s.DynamoDBClient({}),N=a.DynamoDBDocumentClient.from(I),w=process.env.CONNECTIONS_TABLE,u=24,P=async t=>{let o=t.requestContext.connectionId,e=t.queryStringParameters?.workstreamId||"default";console.log(`[CONNECT] connectionId=${o} workstreamId=${e}`);try{let n=Math.floor(Date.now()/1e3)+u*60*60;return await N.send(new a.PutCommand({TableName:w,Item:{connectionId:o,workstreamId:e,connectedAt:new Date().toISOString(),ttl:n}})),{statusCode:200,body:"Connected"}}catch(n){return console.error("[CONNECT] Error:",n),{statusCode:500,body:"Failed to connect"}}};0&&(module.exports={handler});
